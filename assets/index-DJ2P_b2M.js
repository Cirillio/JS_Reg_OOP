(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();const c="dark",g="light";class w{constructor(t,e,i){this.btn=document.getElementById(t),this.light_icon=document.getElementById(e),this.dark_icon=document.getElementById(i),this.root=document.documentElement,this.init()}init(){this.setTheme(this.getTheme()),this.btn.onclick=()=>this.setTheme(this.toggleTheme())}getTheme(){return localStorage.getItem("theme")||this.root.dataset.theme||c}toggleTheme(){return this.getTheme()===c?g:c}setTheme(t){this.root.dataset.theme=t,localStorage.setItem("theme",t),this.light_icon.classList.toggle("hidden",t===g),this.dark_icon.classList.toggle("hidden",t===c)}}class b{constructor(){this.errors=[],this.init()}init(){this.error_list=document.createElement("ul"),this.error_list.classList.add("error-list")}getElement(){return this.error_list}getErrors(){return this.errors}newError(t){const e=document.createElement("li");return e.classList.add("error-item"),e.textContent=t.msg,e}addError(t){this.errors.find(e=>e.id===t.id)||this.errors.push(t)}renderError(t){this.error_list.appendChild(t)}showErrors(){this.errors.length!==0&&this.errors.forEach(t=>this.renderError(this.newError(t)))}clearErrors(){this.error_list.innerHTML="",this.errors=[]}checkErrors(){return!this.errors.length>0}}class d{constructor({name:t,type:e,placeholder:i="",desc:r,validators:o=[]}){this.name=t,this.id=t.split(" ").length>1?t.split(" ").join("-").toLowerCase():t.toLowerCase(),this.type=e,this.placeholder=i,this.desc=r,this.value=null,this.errors=new b,this.valid=!1,this.validators=o,this.listeners=[],this.init()}init(){const t=document.createElement("div");t.classList.add("form-field");const e=document.createElement("label");e.classList.add("form-label"),e.textContent=this.name;const i=document.createElement("input");switch(i.classList.add("form-input"),i.setAttribute("type",this.type),i.setAttribute("name",this.id),i.setAttribute("id",this.id),i.setAttribute("placeholder",this.placeholder),this.type){case"password":i.setAttribute("autocomplete","new-password");break;case"email":i.setAttribute("autocomplete","username");break}const r=document.createElement("div");r.classList.add("form-input-container"),r.appendChild(i);const o=document.createElement("div");o.classList.add("form-input-addittional");const a=document.createElement("button");a.classList.add("form-input-clear"),a.textContent="Clear",a.onclick=()=>this.clearInput(),o.appendChild(a);let l=null;this.type==="password"&&(l=document.createElement("button"),l.classList.add("form-pass-toggle"),l.textContent="👁️",l.onclick=()=>this.togglePass(),this.toggle_pass=l,o.appendChild(l)),r.appendChild(o);let h=null;this.desc&&(h=document.createElement("span"),h.classList.add("form-input-desc"),h.textContent=this.desc);const _=this.errors.getElement();t.appendChild(e),t.appendChild(r),this.desc&&t.appendChild(h),t.appendChild(_),this.input=i,this.label=e,this.form_field=t,this.input.oninput=y=>{this.setValue(y.target.value),this.notify()}}getInput(){return this.input}clearInput(){this.setValue(""),this.input.focus()}togglePass(){console.log(this.input.type),this.input.type==="password"?(this.input.type="text",this.toggle_pass.textContent="🙈"):(this.input.type="password",this.toggle_pass.textContent="👁️"),this.input.focus()}getLabeledInput(){return this.label}setValue(t){this.value=t,this.input.value=t,this.handleValidate()}getValue(){return this.value}getValid(){return this.valid}handleValidate(){this.errors.clearErrors(),this.validate(),this.toggleValid(this.errors.checkErrors()),this.errors.showErrors()}validate(){this.validators.forEach(t=>{try{t(this.value)}catch(e){this.errors.addError(e)}})}onChange(t){this.listeners.push(t)}notify(){this.listeners.forEach(t=>t({value:this.value,errors:this.errors.getErrors(),valid:this.valid}))}toggleValid(t){typeof t=="boolean"&&(this.valid=t,t?this.setValidClass():this.setInvalidClass())}setValidClass(){this.input.classList.remove("invalid"),this.input.classList.add("valid")}setInvalidClass(){this.input.classList.add("invalid"),this.input.classList.remove("valid")}}class E{constructor(){this.inputs={}}registerInput(t){if(t instanceof d){this.inputs[t.name]=t;return}throw new Error("Input must be an instance of the Input class")}getValue(t){return this.inputs[t].getValue()}getFormValues(){const t={};for(const e in this.inputs)t[e]=this.inputs[e].getValue();return t}formValid(){return Object.values(this.inputs).every(t=>t.getValid())}validateInput(t){this.inputs[t].handleValidate()}validateForm(){Object.values(this.inputs).forEach(t=>t.handleValidate())}onChangeInput(t,e){this.inputs[t].onChange(e)}}class v{constructor(t,e,i,r,o){this.status=!1,this.alert=document.querySelector(t),this.loading=document.querySelector(e),this.error=document.querySelector(i),this.response=document.querySelector(r),this.button=document.querySelector(o),this.init()}init(){this.button&&(this.button.onclick=()=>this.closeAlert())}openAlert(){!this.status&&this.alert&&(this.alert.classList.remove("hidden"),this.alert.classList.add("flex"),this.showLoading(),this.status=!0)}closeAlert(){this.status&&this.alert&&(this.alert.classList.remove("flex"),this.alert.classList.add("hidden"),this.hideLoading(),this.hideError(),this.hideResponse(),this.status=!1)}showLoading(){this.loading&&this.loading.classList.remove("result-hidden"),this.hideError(),this.hideResponse()}hideLoading(){this.loading&&this.loading.classList.add("result-hidden")}setError(t){this.hideLoading(),this.hideResponse(),this.error&&typeof t=="string"&&(this.error.textContent=t,this.error.classList.remove("result-hidden"))}hideError(){this.error&&this.error.classList.add("result-hidden")}setResponse(t){this.hideLoading(),this.hideError(),this.response&&typeof t=="string"&&(this.response.textContent=t,this.response.classList.remove("result-hidden"))}hideResponse(){this.response&&this.response.classList.add("result-hidden")}}class L{constructor(t=[]){this.state=new E,this.inputs=t,this.validaty=null,this.form_data={},this.alert=new v(".result-container",".result-loading",".result-error",".result-response",".result-close"),this.init(),this.initFormChange()}init(){const t=document.createElement("form");if(t.classList.add("form"),t.onsubmit=r=>r.preventDefault(),this.inputs.length===0){t.appendChild(document.createElement("p").textContent="You didn't add any inputs");return}this.inputs.forEach(r=>t.appendChild(r.form_field));const e=document.createElement("button");e.classList.add("form-button"),e.disabled=!0,e.textContent="Send",this.submit_btn=e,this.submit_btn.onclick=()=>this.onSubmit();const i=document.createElement("div");i.classList.add("horizontal-divider"),t.appendChild(i),t.appendChild(e),this.form=t}initFormChange(){if(!this.inputs.every(t=>t instanceof d))throw new Error("Input must be an instance of the Input class");this.inputs.forEach(t=>{this.state.registerInput(t),this.state.onChangeInput(t.name,()=>{const e=this.state.formValid();this.toggleFormButton(e)})}),this.state.onChangeInput("Password",()=>{this.state.validateInput("Password confirm")})}render(t){document.querySelector(t).appendChild(this.form)}checkResult(){if(!this.form_data||!this.validaty)throw new Error("Form is not valid")}async onSubmit(){try{this.makeResult(),this.checkResult(),this.alert.openAlert(),await this.sendResult().then(t=>this.alert.setResponse(t.status===200?"Registered successfully":t.status)).catch(t=>this.alert.setError(t.message))}catch(t){this.alert.openAlert(),this.alert.setError(t.message)}}makeResult(){this.state.validateForm(),this.validaty=this.state.formValid(),this.form_data=this.state.getFormValues()}async sendResult(t="post",e="https://httpbin.org"){return fetch(e+"/"+t,{method:t.toUpperCase(),headers:{"Content-Type":"application/json"},body:JSON.stringify(this.form_data)})}toggleFormButton(t){this.submit_btn.disabled=!t}}function u(s){return s.toLowerCase()!==s.toUpperCase()}function m(s){return s>="0"&&s<="9"}const f=["-","'"],p=["-","_","."],n={length:(s=null,t=null)=>e=>{e===null&&(e="");const i=e.length<1?"Required":e.length<s&&s?`At least ${s} characters`:e.length>t&&t?`At most ${t} characters`:null;if(i)throw{id:303,msg:i}},name_spec_symbols:s=>{if(s.trim().split("").filter((e,i)=>f.includes(e)&&(e===s[i-1]||e===s[i+1])).length>0)throw{id:303,msg:"Repeating special characters are not allowed"}},name_symbols:s=>{for(const t of s)if(!u(t)&&!f.includes(t))throw{id:302,msg:"Only letters, hyphens and apostrophes are allowed"}},email:s=>{const t=s.trim(),[e,i]=t.split("@");if(!e||!i)throw{id:341,msg:"Invalid email structure"}},email_structure:s=>{if(!s.trim().includes("@")||!s.trim().includes("."))throw{id:313,msg:"Must contain '@' and '.'"}},email_local_symbols:s=>{const[t,e]=s.trim().split("@");if(t){for(const i of t)if(!u(i)&&!m(i)&&!p.includes(i))throw{id:317,msg:"Only letters, digits, hyphens, underscores and dots are allowed"}}},email_local_spec_symbols:s=>{const[t,e]=s.trim().split("@");if(!t)return;const i=["-","_","."];if(t.trim().split("").filter((o,a)=>i.includes(o)&&(o===t[a-1]||o===t[a+1])).length>0)throw{id:304,msg:"Repeating special characters are not allowed"}},email_local_spec_borders:s=>{const[t,e]=s.trim().split("@");if(!t)return;const i=t[0],r=t[t.length-1];if(p.includes(i)||p.includes(r))throw{id:311,msg:"Special characters are not allowed at the beginning and end"}},email_domain_symbols:s=>{const[t,e]=s.trim().split("@");if(!e)return;function i(r){const a=r.trim().split(".");if(a.length!==2||a.some(l=>l.length===0))return!1;for(const l of a)for(const h of l)if(!u(h)&&!m(h))return!1;return!0}if(!i(e))throw{id:309,msg:"Email domain must contain only letters and digits separated by one dot"}},pass_digits:s=>{if(!s.trim().split("").some(e=>m(e)))throw{id:333,msg:"Password must contain at least one digit"}},pass_symbols:s=>{if(!s.trim().split("").some(e=>!u(e)&&!m(e)))throw{id:334,msg:"Password must contain at least one special symbol"}},pass_cases:s=>{function t(o){return o===o.toUpperCase()&&o!==o.toLowerCase()}function e(o){return o===o.toLowerCase()&&o!==o.toUpperCase()}const i=s.trim().split("").filter(t),r=s.trim().split("").filter(e);if(i.length<1||r.length<1)throw{id:335,msg:"Password must contain at least one uppercase and lowercase letter"}},matchPass:s=>t=>{const e=s();if(t!==e)throw{id:336,msg:"Passwords do not match"}},year_valid:s=>{const t=new Date(s);if(t.getFullYear()<1901||t>new Date)throw{id:340,msg:"Year must be greater than 1901 and not in the future =)"}},old_enough:s=>{const t=new Date(s),e=new Date,i=e.getFullYear()-t.getFullYear();if(!(i>18||i===18&&(e.getMonth()>t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()>=t.getDate())))throw{id:339,msg:"Your age is too small"}}};document.addEventListener("DOMContentLoaded",()=>{new w("theme-toggle","icon-light","icon-dark");const s=[n.name_spec_symbols,n.name_symbols,n.length(1,40)],t=[n.length(),n.email,n.email_structure,n.email_local_symbols,n.email_local_spec_symbols,n.email_local_spec_borders,n.email_domain_symbols],e=[n.pass_digits,n.pass_cases,n.pass_symbols,n.length(8)],i=[n.length(8),n.matchPass(()=>o.inputs[3].getValue())],r=[n.length(),n.year_valid,n.old_enough],o=new L([new d({name:"First name",type:"text",placeholder:"Your name is...",validators:s}),new d({name:"Last name",type:"text",placeholder:"Enter your last name",validators:s}),new d({name:"Email",type:"email",placeholder:"Enter your email",validators:t}),new d({name:"Password",type:"password",placeholder:"Enter your password",desc:"Your password must be strong enough",validators:e}),new d({name:"Password confirm",type:"password",placeholder:"Repeat your password",validators:i}),new d({name:"Birth day",type:"date",placeholder:"When were you born?",desc:"You must be at least 18 years old",validators:r})]);o.render(".form-outer")});
