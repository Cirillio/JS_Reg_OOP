(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();class a{constructor(t,e,s="",i=[]){this.name=t,this.id=t.split(" ").length>1?t.split(" ").join("-").toLowerCase():t.toLowerCase(),this.type=e,this.placeholder=s,this.value=null,this.error=null,this.valid=!1,this.validators=i,this.listeners=[],this.init()}init(){const t=document.createElement("div");t.classList.add("form-field");const e=document.createElement("label");e.classList.add("form-label"),e.textContent=this.name,t.appendChild(e);const s=document.createElement("input");s.classList.add("form-input"),s.setAttribute("type",this.type),s.setAttribute("name",this.id),s.setAttribute("id",this.id),s.setAttribute("placeholder",this.placeholder),t.appendChild(s),this.input=s,this.label=e,this.form_field=t,this.input.oninput=i=>{this.setValue(i.target.value),this.notify()}}getInput(){return this.input}getLabeledInput(){return this.label}setValue(t){this.value=t,this.input.value=t,this.validate()}getValue(){return this.value}getValid(){return this.valid}getError(){return this.error}validate(){this.validators.forEach(t=>{const e=t(this.value);this.toggleValid(e)}),console.log(this.name,this.value,this.error,this.valid)}onChange(t){this.listeners.push(t)}notify(){this.listeners.forEach(t=>t({value:this.value,error:this.error,valid:this.valid}))}toggleValid(t){this.error=t,this.valid=!this.error,this.valid?this.setValidClass():this.setInvalidClass()}setValidClass(){this.input.classList.remove("invalid")}setInvalidClass(){this.input.classList.add("invalid")}}class l{constructor(){this.inputs={}}registerInput(t){if(t instanceof a){this.inputs[t.name]=t;return}throw new Error("Input must be an instance of the Input class")}getValue(t){return this.inputs[t].getValue()}getFormValues(){const t={};for(const e in this.inputs)t[e]=this.inputs[e].getValue();return t}formValid(){const t=Object.values(this.inputs).every(e=>e.getValid());return console.log(t),t}validateInput(t){this.inputs[t].validate()}validateForm(){Object.values(this.inputs).forEach(t=>t.validate())}onChangeInput(t,e){this.inputs[t].onChange(e)}}class u{constructor(t=[]){this.state=new l,this.inputs=t,this.validaty=null,this.form_data={},this.init(),this.initFormChange()}init(){const t=document.createElement("form");t.classList.add("form"),t.onsubmit=s=>s.preventDefault(),this.inputs.forEach(s=>t.appendChild(s.form_field));const e=document.createElement("button");e.classList.add("form-button"),e.disabled=!0,e.textContent="Send",this.submit_btn=e,this.submit_btn.onclick=()=>this.onSubmit(),t.appendChild(e),this.form=t}initFormChange(){if(!this.inputs.every(t=>t instanceof a))throw new Error("Input must be an instance of the Input class");this.inputs.forEach(t=>{this.state.registerInput(t),this.state.onChangeInput(t.name,()=>{const e=this.state.formValid();this.toggleFormButton(e)})}),this.state.onChangeInput("Password",()=>{this.state.validateInput("Password confirm")})}render(t){document.querySelector(t).appendChild(this.form)}checkResult(){if(!this.form_data||!this.validaty)throw new Error("Form is not valid")}async onSubmit(){try{this.makeResult(),this.checkResult(),await this.sendResult().then(t=>console.log(t)).catch(t=>console.log(t))}catch(t){console.log(t)}}makeResult(){this.state.validateForm(),this.validaty=this.state.formValid(),this.form_data=this.state.getFormValues()}async sendResult(t="post",e="https://httpbin.org"){return fetch(e+"/"+t,{method:t.toUpperCase(),headers:{"Content-Type":"application/json"},body:JSON.stringify(this.form_data)})}toggleFormButton(t){this.submit_btn.disabled=!t}}document.addEventListener("DOMContentLoaded",()=>{console.log("load");const n={name:e=>/^[A-Za-zА-Яа-яёЁ'\\-]{2,40}$/.test(e.trim())?null:"Only letters, hyphens and apostrophes are allowed",email:e=>/^\S+@\S+\.\S+$/.test(e.trim())?null:"Incorrect email",pass:e=>e.length<8?"At least 8 characters":/[a-z]/.test(e)?/[A-Z]/.test(e)?/[0-9]/.test(e)?/[^a-zA-Z0-9]/.test(e)?null:"At least one special character":"At least one digit":"At least one uppercase letter":"At least one lowercase letter",matchPass:e=>s=>s===e()?null:"Passwords do not match",age:e=>{if(!e)return"Required";const s=new Date(e),i=new Date,r=i.getFullYear()-s.getFullYear(),o=r>18||r===18&&(i.getMonth()>s.getMonth()||i.getMonth()===s.getMonth()&&i.getDate()>=s.getDate());return s.getFullYear()>=1901?o?null:"You must be at least 18 years old":"Year must be 1901 or later"}},t=new u([new a("First name","text","Your name is...",[n.name]),new a("Last name","text","Enter your last name",[n.name]),new a("Email","email","Enter your email",[n.email]),new a("Password","password","Enter your password",[n.pass]),new a("Password confirm","password","Repeat your password",[n.matchPass(()=>t.inputs[3].getValue())]),new a("Birth day","date","When were you born?",[n.age])]);t.render(".form-outer")});
